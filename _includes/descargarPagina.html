<style>
    @media print {

        /* Ocultar el idioma no seleccionado */
        html[lang="es"] .content-en,
        html[lang="en"] .content-es {
            display: none !important;
        }

        /* Ocultar elementos innecesarios en la impresión */
        header,
        footer,
        nav,
        .selectorDeIdioma,
        .boton-descargar-pdf {
            display: none !important;
        }

        /* Forzar que los títulos no queden solos al final de la página */
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        section,
        .portada-titulos,
        .portada-titulo,
        .portada-subtitulo,
        .autor {
            page-break-after: avoid;
            break-after: avoid;
            -webkit-column-break-after: avoid;
            page-break-inside: avoid;
            break-inside: avoid;
            margin-bottom: 0 !important;
        }

        /* Asegurar que el cuerpo ocupe el 100% y tenga fondo blanco */
        body,
        article {
            background-color: white !important;
            color: black !important;
            margin: 0 !important;
            padding: 0 !important;
            width: 100% !important;
            box-shadow: none !important;
            /* CRITICAL: Cambiar display flex a block para evitar problemas de paginación en impresión */
            display: block !important;
        }

        /* Tipografía legible para impresión */
        body {
            font-size: 12pt;
        }

        /* Evitar que las imágenes se corten entre páginas */
        figure,
        img {
            max-width: 100% !important;
            page-break-inside: avoid !important;
            break-inside: avoid !important;
            display: block !important;
            margin: 0 auto !important;
        }

        /* Evitar cortes en párrafos */
        p,
        h2,
        h3 {
            orphans: 2;
            widows: 2;
        }

        /* Mostrar la URL de los enlaces */
        a:after {
            content: " (" attr(href) ")";
            font-size: 0.8em;
        }

        /* Asegurar que los títulos y subtítulos tengan color y fondo legibles */
        .portada-titulos,
        .portada-titulo,
        .portada-subtitulo {
            color: #dfa776 !important;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
            background-color: rgb(0, 0, 0) !important;
        }

        .portada figcaption {
            color: black !important;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }

        /* Asegurar que se mantenga el degradado y la visibilidad de la portada en Safari */
        .portada {
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;

            /* Override inline background-image to remove the gradient layer that breaks Safari print */
            background-image: url('{{ page.imagenPortada }}') !important;
            background-size: cover !important;
            background-position: center !important;

            /* Fix: Establecer contexto de posicionamiento para que los títulos absolutos se queden aquí */
            position: relative !important;
            height: 100vh !important;
            width: 100% !important;
            page-break-after: always !important;
            overflow: hidden !important;
            display: block !important;

            /* Quitar cualquier máscara que pueda causar recuadros negros en Safari */
            -webkit-mask-image: none !important;
            mask-image: none !important;
        }


        .portada img {
            -webkit-mask-image: none !important;
            mask-image: none !important;
            object-fit: cover !important;
            width: 100% !important;
            height: 100% !important;
        }

        /* Asegurar que el texto de portada esté correctamente posicionado */
        .portada .portada-titulos {
            position: absolute !important;
            bottom: 10px !important;
            z-index: 10 !important;
        }

        /* Se modifican los colores a blanco para la plantilla de frase y texto */
        .frase,
        .frase-autor,
        .frase-contexto {
            color: white !important;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }

    }
</style>

<div class="boton-descargar-pdf"
    style="display: flex; justify-content: center; align-items: center; width: fit-content; margin: 20px auto">
    <button onclick="window.print()" class="boton-descargar-pdf content-es">
        Descargar
    </button>
    <button onclick="window.print()" class="boton-descargar-pdf content-en" style="display: none;">
        Download
    </button>
</div>