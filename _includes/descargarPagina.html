<style>
    @media print {

        /* Ocultar el idioma no seleccionado */
        html[lang="es"] .content-en,
        html[lang="en"] .content-es {
            display: none !important;
        }

        /* Ocultar elementos innecesarios en la impresión */
        header,
        footer,
        nav,
        .selectorDeIdioma,
        .boton-descargar-pdf,
        #nav,
        .navbar,
        .nav-bar {
            display: none !important;
            visibility: hidden !important;
            height: 0 !important;
            width: 0 !important;
            margin: 0 !important;
            padding: 0 !important;
            opacity: 0 !important;
            border: none !important;
        }

        /* Forzar que los títulos no queden solos al final de la página */
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        .portada-titulos,
        .portada-titulo,
        .portada-subtitulo,
        .autor {
            page-break-after: avoid;
            break-after: avoid;
            -webkit-column-break-after: avoid;
            page-break-inside: avoid;
            break-inside: avoid;
            margin-bottom: 0 !important;
        }

        /* Configuración inteligente de saltos de página para secciones */
        section {
            /* Intentar no dividir una sección en dos páginas */
            break-inside: avoid;
            page-break-inside: avoid;

            /* Permitir que compartan página si caben */
            break-before: auto;
            page-break-before: auto;

            /* Asegurar espacio visual si comparten página */
            margin-bottom: 2cm !important;
            display: block !important;
        }

        /* Asegurar que el cuerpo ocupe el 100% y tenga fondo blanco */
        body,
        article {
            background-color: white !important;
            color: black !important;
            margin: 0 !important;
            padding: 0 !important;
            width: 100% !important;
            box-shadow: none !important;
            /* CRITICAL: Cambiar display flex a block para evitar problemas de paginación en impresión */
            display: block !important;
        }

        /* Tipografía legible para impresión */
        body {
            font-size: 12pt;
        }

        /* Evitar que las imágenes se corten entre páginas */
        figure,
        img {
            max-width: 100% !important;
            page-break-inside: avoid !important;
            break-inside: avoid !important;
            display: block !important;
            margin: 0 auto !important;
        }

        /* Evitar cortes en párrafos */
        p,
        h2,
        h3 {
            orphans: 2;
            widows: 2;
        }

        /* Asegurar que los enlaces se muestren correctamente */
        a {
            color: #000000 !important;
            text-decoration: underline !important;
        }

        button a {
            color: #dfa776 !important;
            text-decoration: underline !important;
        }

        /* Mostrar la URL de los enlaces */
        a:after {
            content: " (" attr(href) ")";
            font-size: 0.8em;
        }



        /* Asegurar que los títulos y subtítulos tengan color y fondo legibles */
        .portada-titulos,
        .portada-titulo,
        .portada-subtitulo {
            color: #dfa776 !important;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
            background-color: rgb(0, 0, 0) !important;
        }

        .portada figcaption {
            color: black !important;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }

        /* Asegurar que se mantenga el degradado y la visibilidad de la portada en Safari */
        .portada {
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;

            /* Override inline background-image to remove the gradient layer that breaks Safari print */
            background-image: url('{{ page.imagenPortada }}') !important;
            background-size: cover !important;
            background-position: center !important;

            /* Fix: Establecer contexto de posicionamiento para que los títulos absolutos se queden aquí */
            position: relative !important;
            height: 100vh !important;
            width: 100% !important;
            page-break-after: always !important;
            overflow: hidden !important;
            display: block !important;

            /* Quitar cualquier máscara que pueda causar recuadros negros en Safari */
            -webkit-mask-image: none !important;
            mask-image: none !important;
        }


        .portada img {
            -webkit-mask-image: none !important;
            mask-image: none !important;
            object-fit: cover !important;
            width: 100% !important;
            height: 100% !important;
        }

        /* Asegurar que el texto de portada esté correctamente posicionado */
        .portada .portada-titulos {
            position: absolute !important;
            bottom: 10px !important;
            z-index: 10 !important;
        }

        /* Se compacta el iframe a la mitad de la altura de la pantalla para que se muestre correctamente en el documento descargado */

        .iframe {
            max-height: 60vh !important;
            width: auto !important;
            margin: 0 auto !important;
            aspect-ratio: auto !important;
            /* Permitir que el aspect ratio se rompa si es necesario para ajustar la altura */
            display: flex !important;
            justify-content: center !important;
        }

        .iframe iframe {
            height: 60vh !important;
            width: auto !important;
            aspect-ratio: 320 / 460 !important;
        }

        /* Se modifican los colores a blanco para la plantilla de frase y texto */

        .frase,
        .frase-autor,
        .frase-contexto {
            color: white !important;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }



    }

    /* Estilos para el botón de descarga */

    .boton-descargar-pdf button {
        background-color: black;
        color: color-mix(in srgb, var(--color-texto-articulo), transparent 0%);
        border: 1px solid transparent;
        background-image: linear-gradient(black, black), linear-gradient(to right, transparent, #683509, transparent);
        background-origin: border-box;
        background-clip: padding-box, border-box;
    }

    .boton-descargar-pdf button {
        transition: all 1s ease;
    }

    .boton-descargar-pdf button:hover {
        background-color: #683509;
        color: var(--color-enlaces);
        border: 1px solid transparent;
        background-image: linear-gradient(black, black), linear-gradient(to right, transparent, #683509, transparent);
        background-origin: border-box;
        background-clip: padding-box, border-box;
    }
</style>

<div class="boton-descargar-pdf"
    style="display: flex; justify-content: center; align-items: center; width: fit-content; margin: 20px auto">
    <button onclick="window.print()" class="boton-descargar-pdf content-es"
        title="Selecciona 'Guardar como PDF' como opción de impresora">
        Descargar artículo
    </button>
    <button onclick="window.print()" class="boton-descargar-pdf content-en"
        title="Select 'Save as PDF' as printer option">
        Download article
    </button>
</div>